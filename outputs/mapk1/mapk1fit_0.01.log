Setting feature_perturbation = "tree_path_dependent" because no background data was given.
Setting feature_perturbation = "tree_path_dependent" because no background data was given.
Setting feature_perturbation = "tree_path_dependent" because no background data was given.
Setting feature_perturbation = "tree_path_dependent" because no background data was given.
Setting feature_perturbation = "tree_path_dependent" because no background data was given.

 # python shapanalysis.py -i ../inputs/mapk1.csv -o ../outputs/mapk1/mapk1fit_0.01 -f 14 -t 0.25 -l 0.01 -n 1550 -d 7 -w 25 -g 0 -s 0.7 -c 0.4 -a 0.001 

<IPython.core.display.HTML object>
         Conservation  Avg_Corr  Avg_Commutetime  ...  PSSM_MUT  HB_WT  HB_MUT
Variant                                           ...                         
A2D          0.090617  0.012172      4346.738856  ...         0    1.8    -3.5
A2G          0.090617  0.012172      4346.738856  ...        -1    1.8    -0.4
A2M          0.090617  0.012172      4346.738856  ...         2    1.8     1.9
A2T          0.090617  0.012172      4346.738856  ...         0    1.8    -0.7
A2Y          0.090617  0.012172      4346.738856  ...         1    1.8    -1.3
...               ...       ...              ...  ...       ...    ...     ...
R359M        0.207153  0.192672      5035.837760  ...         1   -4.5     1.9
R359S        0.207153  0.192672      5035.837760  ...         0   -4.5    -0.8
S360A        0.155917  0.036444      5931.055740  ...        -1   -0.8     1.8
S360H        0.155917  0.036444      5931.055740  ...         2   -0.8    -3.2
S360P        0.155917  0.036444      5931.055740  ...         0   -0.8    -1.6

[4470 rows x 11 columns]          Scaled_Fitness
Variant                
A2D            0.726131
A2G            0.713552
A2M            0.555608
A2T            0.746730
A2Y            0.833747
...                 ...
R359M          0.533035
R359S          0.486010
S360A          0.648770
S360H          0.924647
S360P          0.429209

[4470 rows x 1 columns]
Index(['Conservation', 'Avg_Corr', 'Avg_Commutetime', 'Contacts', 'BLOSUM',
       'SASA', 'SS', 'PSSM_WT', 'PSSM_MUT', 'HB_WT', 'HB_MUT'],
      dtype='object')

XGB Parameters {'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 0.4, 'gamma': 0.0, 'importance_type': 'gain', 'learning_rate': 0.01, 'max_delta_step': 0, 'max_depth': 7, 'min_child_weight': 25.0, 'missing': None, 'n_estimators': 1550, 'nthread': 1, 'objective': 'reg:squarederror', 'reg_alpha': 0.001, 'reg_lambda': 1, 'scale_pos_weight': 1, 'seed': 27, 'subsample': 0.7, 'verbosity': 1}

Test RMSE: 0.179353
Train RMSE: 0.140046
R2_train 0.774111526046426 R2_test 0.6194420113906283 R2_all 0.7362201924674543


k-fold cross validation analysis
nsplits =  4
KFold(n_splits=4, random_state=123, shuffle=True)
Fold  1
Test RMSE: 0.179365
Train RMSE: 0.139616
Fold  2
Test RMSE: 0.182997
Train RMSE: 0.138041
Fold  3
Test RMSE: 0.177935
Train RMSE: 0.139469
Fold  4
Test RMSE: 0.173819
Train RMSE: 0.140730
Mean train rmse= 0.1394638553311101 Std train rmse= 0.0009554077296273242
Mean test rmse= 0.17852909783567364 Std test rmse= 0.003286271414267431


Robustness of SHAP values-Correlation between SHAP values from different CV models

Feature,Mean Correlation,Std. deviaion of Correlation
Conservation,0.9875427358958722,0.0013466967629279254
Avg_Corr,0.9627543734847213,0.0068264322934197125
Avg_Commutetime,0.9538297101157064,0.004578875161093829
Contacts,0.9254186903585503,0.009749641065663308
BLOSUM,0.9542334372465798,0.012196302349688708
SASA,0.9550892572748982,0.005399571899607901
SS,0.8726297806052701,0.0540786287119361
PSSM_WT,0.9669102477094039,0.005434737464950188
PSSM_MUT,0.957550955204523,0.005523563995571028
HB_WT,0.950967126026569,0.0017811293859944695
HB_MUT,0.9725890272186465,0.0038037242861871656
